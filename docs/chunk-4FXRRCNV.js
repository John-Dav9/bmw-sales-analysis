import{a as $}from"./chunk-QQYKQ6NF.js";import{b as W}from"./chunk-FYPI2E2L.js";import{d as X,e as Y,f as Z}from"./chunk-XS5RH2OV.js";import{A as T,B as N,C as H,F as K,J,K as Q,z as B}from"./chunk-NODSVL4F.js";import{a as F,b as I,c as L,d as k,f as O,k as q,l as D,m as x,n as j,o as A,r as U,s as z,t as G}from"./chunk-RJDHG7FO.js";import{$ as m,Ad as R,Cb as E,Dc as b,Gb as r,Ib as V,Ka as _,Lb as d,Mb as p,Nb as u,X as f,aa as s,fb as y,gb as i,hb as n,n as w,pb as C,rb as S,yc as P,za as o,zd as v}from"./chunk-TOSGPUWZ.js";import{d as h}from"./chunk-4CLCTAJ7.js";var ee=class M{http=f(b);snack=f(B);auth=f($);router=f(W);name="";surname="";email="";password="";confirmPassword="";role="visitor";loading=!1;register(){return h(this,null,function*(){if(this.password!==this.confirmPassword){this.snack.open("Les mots de passe ne correspondent pas","Fermer",{duration:2500});return}this.loading=!0;try{let l=yield w(this.http.post(`${N.apiBase}/auth/register`,{name:this.name,surname:this.surname,email:this.email,password:this.password,role:this.role}));this.auth.saveSession(l.access_token,l.user),this.snack.open("Inscription r\xE9ussie !","OK",{duration:2e3}),l.user?.role==="admin"?this.router.createUrlTree(["/admin"]):this.router.createUrlTree(["/"])}catch(l){this.snack.open(l?.error?.message||"Erreur lors de l\u2019inscription","Fermer",{duration:3e3})}finally{this.loading=!1}})}static \u0275fac=function(c){return new(c||M)};static \u0275cmp=_({type:M,selectors:[["app-register"]],decls:41,vars:8,consts:[["form","ngForm"],[1,"auth-wrapper"],[1,"auth-card"],[1,"form",3,"ngSubmit"],["appearance","outline"],["matInput","","name","name","required","","minlength","2",3,"ngModelChange","ngModel"],["matInput","","name","surname","required","","minlength","2",3,"ngModelChange","ngModel"],["matInput","","name","email","type","email","required","",3,"ngModelChange","ngModel"],["matInput","","name","password","type","password","required","","minlength","6",3,"ngModelChange","ngModel"],["matInput","","name","confirmPassword","type","password","required","","minlength","6",3,"ngModelChange","ngModel"],["name","role","required","",3,"ngModelChange","ngModel"],["value","visitor"],["value","admin"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"switch"],["routerLink","/login"]],template:function(c,t){if(c&1){let a=C();i(0,"div",1)(1,"mat-card",2)(2,"mat-card-title"),r(3,"Cr\xE9er un compte"),n(),i(4,"mat-card-content")(5,"form",3,0),S("ngSubmit",function(){return m(a),s(t.register())}),i(7,"mat-form-field",4)(8,"mat-label"),r(9,"Nom"),n(),i(10,"input",5),u("ngModelChange",function(e){return m(a),p(t.name,e)||(t.name=e),s(e)}),n()(),i(11,"mat-form-field",4)(12,"mat-label"),r(13,"Pr\xE9nom"),n(),i(14,"input",6),u("ngModelChange",function(e){return m(a),p(t.surname,e)||(t.surname=e),s(e)}),n()(),i(15,"mat-form-field",4)(16,"mat-label"),r(17,"Email"),n(),i(18,"input",7),u("ngModelChange",function(e){return m(a),p(t.email,e)||(t.email=e),s(e)}),n()(),i(19,"mat-form-field",4)(20,"mat-label"),r(21,"Mot de passe"),n(),i(22,"input",8),u("ngModelChange",function(e){return m(a),p(t.password,e)||(t.password=e),s(e)}),n()(),i(23,"mat-form-field",4)(24,"mat-label"),r(25,"Confirmer le mot de passe"),n(),i(26,"input",9),u("ngModelChange",function(e){return m(a),p(t.confirmPassword,e)||(t.confirmPassword=e),s(e)}),n()(),i(27,"mat-form-field",4)(28,"mat-label"),r(29,"R\xF4le"),n(),i(30,"mat-select",10),u("ngModelChange",function(e){return m(a),p(t.role,e)||(t.role=e),s(e)}),i(31,"mat-option",11),r(32,"Visiteur"),n(),i(33,"mat-option",12),r(34,"Admin"),n()()(),i(35,"button",13),r(36),n()(),i(37,"p",14),r(38," D\xE9j\xE0 un compte ? "),i(39,"a",15),r(40,"Se connecter"),n()()()()()}if(c&2){let a=E(6);o(10),d("ngModel",t.name),o(4),d("ngModel",t.surname),o(4),d("ngModel",t.email),o(4),d("ngModel",t.password),o(4),d("ngModel",t.confirmPassword),o(4),d("ngModel",t.role),o(5),y("disabled",a.invalid||t.loading),o(),V(" ",t.loading?"Cr\xE9ation...":"S\u2019inscrire"," ")}},dependencies:[P,G,A,O,q,D,U,z,j,x,k,F,L,I,Q,J,K,H,R,v,Z,Y,X,T],styles:[".auth-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:92vh;background:#f8fafc}.auth-card[_ngcontent-%COMP%]{width:380px;padding:20px}form.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:14px}.switch[_ngcontent-%COMP%]{text-align:center;margin-top:14px;font-size:14px}.switch[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#1a237e;font-weight:500;text-decoration:none}"]})};export{ee as Register};
